# 20. 有效的括号

- **平台**：LeetCode
- **链接**：https://leetcode.cn/problems/valid-parentheses/description/
- **难度**：Easy
- **标签**：栈、字符串

## 题目描述

给定一个只包括 `(`，`)`，`{`，`}`，`[`，`]` 的字符串 `s` ，判断字符串是否有效。

有效字符串需满足：
1. 左括号必须用相同类型的右括号闭合。
2. 左括号必须以正确的顺序闭合。
3. 每个右括号都有一个对应的相同类型的左括号。

## 示例

**示例 1：**
```
输入：s = "()"
输出：true
```

**示例 2：**
```
输入：s = "()[]{}"
输出：true
```

**示例 3：**
```
输入：s = "(]"
输出：false
```

## 解题思路

### 方法：栈

**核心思路：**
- 用一个栈保存尚未匹配的左括号。
- 遇到右括号时，检查栈顶是否是对应的左括号：
  - 若栈为空或栈顶不匹配，立即返回 `false`。
  - 若匹配则弹栈继续。
- 遍历结束后，栈必须为空才是有效括号串。

**关键细节：**
- 若 `s` 长度为奇数，一定不可能完全配对，可提前返回 `false`。
- 使用映射 `pairs = {{')','('}, {']','['}, {'}','{'}}` 方便判断右括号对应的左括号。

## 代码实现

### C++

```cpp
class Solution {
public:
    bool isValid(string s) {
        int n = s.size();
        if (n % 2 == 1) {
            return false;
        }

        unordered_map<char, char> pairs = {
            {')', '('},
            {']', '['},
            {'}', '{'}
        };
        stack<char> stk;
        for (char ch: s) {
            if (pairs.count(ch)) {
                if (stk.empty() || stk.top() != pairs[ch]) {
                    return false;
                }
                stk.pop();
            }
            else {
                stk.push(ch);
            }
        }
        return stk.empty();
    }
};
```

## 复杂度分析

- **时间复杂度**：O(n)，其中 n 是字符串 s 的长度。
- **空间复杂度**：O(n + |Σ|)，其中 Σ 表示字符集。本题中字符串只包含 6 种括号，|Σ| = 6。
  - 栈中的字符数量为 O(n)
  - `pairs` 映射表使用的空间为 O(|Σ|)

## 关键点

1. 使用栈结构处理「后进先出」的匹配关系。
2. 遇到右括号时需要同时处理两类非法情况：
   - 栈为空（没有可匹配的左括号）
   - 栈顶不是对应的左括号（类型不匹配或顺序不正确）
3. 遍历结束后栈必须为空，否则说明仍有未闭合的左括号。